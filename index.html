<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–£ –î–≤–µ—Ä–∏ ‚Äî –º–∏–Ω–∏‚Äë–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
  <style>
    :root { --bg:#fff; --text:#111; --card:#f6f6f6; --muted:#8b8b8b; --accent:#16a34a; --line:#e5e5e5; }
    *{box-sizing:border-box}
    body{margin:0;padding:0;font-family:-apple-system,Segoe UI,Arial,sans-serif;background:var(--bg);color:var(--text)}
    header{position:sticky;top:0;background:var(--bg);padding:14px 16px;border-bottom:1px solid var(--line);z-index:10}
    h1{margin:0;font-size:18px}
    main{padding:16px}
    .hidden{display:none}
    .card{background:var(--card);border-radius:14px;padding:14px;margin:12px 0}
    .title{font-weight:700;margin-bottom:6px}
    .desc{opacity:.9;margin:0 0 10px}
    .row{display:flex;gap:8px}
    input,select{width:100%;padding:12px 12px;border:1px solid var(--line);border-radius:10px;font-size:16px;background:#fff}
    button{width:100%;padding:12px 14px;border:0;border-radius:12px;font-size:16px;cursor:pointer;background:var(--accent);color:#fff}
    small{opacity:.7}

    /* –¢–∞–±—ã —Å–Ω–∏–∑—É */
    nav{position:sticky;bottom:0;background:var(--bg);border-top:1px solid var(--line);display:flex}
    nav button{flex:1;background:transparent;color:inherit;border-radius:0;padding:12px 6px}
    nav button.active{border-top:3px solid var(--accent);}
    .tab-label{display:block;font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <header><h1 id="title">–ó–∞—è–≤–∫–∞</h1></header>
  <main>
    <!-- TAB: REQUEST -->
    <section id="tab-request">
      <div class="card">
        <div class="title">–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</div>
        <p class="desc">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É. –ö—É—Ä—å–µ—Ä –∑–∞–±–µ—Ä—ë—Ç –º—É—Å–æ—Ä —É –¥–≤–µ—Ä–∏.</p>
        <div class="row">
          <select id="bags">
            <option value="1">1 –ø–∞–∫–µ—Ç</option>
            <option value="2" selected>2 –ø–∞–∫–µ—Ç–∞</option>
            <option value="3">3 –ø–∞–∫–µ—Ç–∞</option>
            <option value="4">4 –ø–∞–∫–µ—Ç–∞</option>
            <option value="5">5 –ø–∞–∫–µ—Ç–æ–≤</option>
          </select>
        </div>
        <div style="height:8px"></div>
        <button id="send-request">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
      </div>
      <small>–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –±–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç –∑–∞—è–≤–∫—É –≤ —á–∞—Ç–µ.</small>
    </section>

    <!-- TAB: TARIFFS -->
    <section id="tab-tariffs" class="hidden">
      <div class="card">
        <div class="title">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫</div>
        <p class="desc">–í—ã–Ω–æ—Å –º—É—Å–æ—Ä–∞ ‚Äî 0 ‚ÇΩ. –ü—Ä–æ–±—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å –±–µ–∑ –æ–ø–ª–∞—Ç—ã.</p>
        <button data-plan="free" class="choose-plan">–í—ã–±—Ä–∞—Ç—å ¬´–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π¬ª</button>
      </div>
      <div class="card">
        <div class="title">–ü–ª—é—Å</div>
        <p class="desc">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π –≤—ã–µ–∑–¥ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è.</p>
        <button data-plan="plus" class="choose-plan">–í—ã–±—Ä–∞—Ç—å ¬´–ü–ª—é—Å¬ª</button>
      </div>
      <small>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ ‚Äî –≤ —á–∞—Ç–µ —Å –±–æ—Ç–æ–º.</small>
    </section>

    <!-- TAB: ADDRESS -->
    <section id="tab-address" class="hidden">
      <div class="card">
        <div class="title">–ò–∑–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å</div>
        <div class="row"><input id="addr_city" placeholder="–ì–æ—Ä–æ–¥" /></div>
        <div class="row"><input id="addr_street" placeholder="–£–ª–∏—Ü–∞" /></div>
        <div class="row"><input id="addr_house" placeholder="–î–æ–º" /></div>
        <div class="row"><input id="addr_flat" placeholder="–ö–≤–∞—Ä—Ç–∏—Ä–∞" /></div>
        <div class="row"><input id="addr_entrance" placeholder="–ü–æ–¥—ä–µ–∑–¥" /></div>
        <div class="row"><input id="addr_floor" placeholder="–≠—Ç–∞–∂" /></div>
        <div class="row"><input id="addr_comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –∫—É—Ä—å–µ—Ä–∞" /></div>
        <div style="height:8px"></div>
        <button id="save-address">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–¥—Ä–µ—Å</button>
      </div>
      <small>–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∞–¥—Ä–µ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞—è–≤–∫–∞—Ö.</small>
    </section>

    <!-- TAB: PROFILE -->
    <section id="tab-profile" class="hidden">
      <div class="card">
        <div class="title">–ü—Ä–æ—Ñ–∏–ª—å</div>
        <p class="desc">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ—Ñ–∏–ª—è –≤ —á–∞—Ç–µ (–∏–º—è, —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∞, –∞–¥—Ä–µ—Å).</p>
        <button id="load-profile">–ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –≤ —á–∞—Ç–µ</button>
      </div>
      <small>–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –≤ –≤–∞—à —á–∞—Ç.</small>
    </section>
  </main>

  <nav>
    <button data-tab="request" class="active">üß∫<span class="tab-label">–ó–∞—è–≤–∫–∞</span></button>
    <button data-tab="tariffs">üí≥<span class="tab-label">–¢–∞—Ä–∏—Ñ—ã</span></button>
    <button data-tab="address">üè†<span class="tab-label">–ê–¥—Ä–µ—Å</span></button>
    <button data-tab="profile">üë§<span class="tab-label">–ü—Ä–æ—Ñ–∏–ª—å</span></button>
  </nav>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –ü–æ–¥—Ö–≤–∞—Ç —Ç–µ–º—ã –¢–µ–ª–µ–≥—Ä–∞–º–∞
    const tp = tg.themeParams || {};
    const cssVars = {
      '--bg': tp.bg_color,
      '--text': tp.text_color,
      '--card': tp.secondary_bg_color,
      '--accent': tp.button_color,
      '--line': tp.section_separator_color,
      '--muted': tp.hint_color,
    };
    Object.entries(cssVars).forEach(([k,v])=>{ if(v) document.documentElement.style.setProperty(k,v); });

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º
    const titleEl = document.getElementById('title');
    const tabs = ['request','tariffs','address','profile'];
    function showTab(tab){
      tabs.forEach(t => document.getElementById('tab-'+t).classList.toggle('hidden', t!==tab));
      document.querySelectorAll('nav button').forEach(b=>b.classList.toggle('active', b.dataset.tab===tab));
      const titles = {request:'–ó–∞—è–≤–∫–∞', tariffs:'–¢–∞—Ä–∏—Ñ—ã', address:'–ê–¥—Ä–µ—Å', profile:'–ü—Ä–æ—Ñ–∏–ª—å'};
      titleEl.textContent = titles[tab] || '–ú–µ–Ω—é';
    }
    document.querySelectorAll('nav button').forEach(b=>b.onclick=()=>showTab(b.dataset.tab));

    // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä—è–º–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω—É–∂–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ —á–µ—Ä–µ–∑ ?tab=
    const params = new URLSearchParams(location.search);
    const initialTab = params.get('tab');
    showTab(tabs.includes(initialTab)?initialTab:'request');

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É (–±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –±—ç–∫–∞)
    function send(action, payload){
      tg.sendData(JSON.stringify({ action, ...payload }));
    }

    // –ó–∞—è–≤–∫–∞
    document.getElementById('send-request').onclick = () => {
      const bags = parseInt(document.getElementById('bags').value,10) || 1;
      send('submit_request', { bags });
      tg.showPopup({ title:'–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞', message:`–ü–∞–∫–µ—Ç–æ–≤: ${bags}. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç.`, buttons:[{type:'close'}] });
    };

    // –í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞
    document.querySelectorAll('.choose-plan').forEach(btn => btn.onclick = () => {
      send('pick_tariff', { plan: btn.dataset.plan });
      tg.showPopup({ title:'–¢–∞—Ä–∏—Ñ –≤—ã–±—Ä–∞–Ω', message:`–í—ã –≤—ã–±—Ä–∞–ª–∏ —Ç–∞—Ä–∏—Ñ: ${btn.dataset.plan}`, buttons:[{type:'close'}] });
    });

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞
    document.getElementById('save-address').onclick = () => {
      const data = {
        city: document.getElementById('addr_city').value.trim(),
        street: document.getElementById('addr_street').value.trim(),
        house: document.getElementById('addr_house').value.trim(),
        flat: document.getElementById('addr_flat').value.trim(),
        entrance: document.getElementById('addr_entrance').value.trim(),
        floor: document.getElementById('addr_floor').value.trim(),
        comment: document.getElementById('addr_comment').value.trim(),
      };
      send('edit_address', data);
      tg.showPopup({ title:'–ê–¥—Ä–µ—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω', message:'–ú—ã –æ–±–Ω–æ–≤–∏–ª–∏ –≤–∞—à –∞–¥—Ä–µ—Å. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Äî –≤ —á–∞—Ç–µ.', buttons:[{type:'close'}] });
    };

    // –ü—Ä–æ—Ñ–∏–ª—å ‚Äî –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ —á–∞—Ç
    document.getElementById('load-profile').onclick = () => {
      send('get_profile', {});
      tg.showPopup({ title:'–ü—Ä–æ—Ñ–∏–ª—å', message:'–û—Ç–ø—Ä–∞–≤–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –≤ –≤–∞—à —á–∞—Ç.', buttons:[{type:'close'}] });
    };
  </script>
</body>
</html>
